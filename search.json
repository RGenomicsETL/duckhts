[{"path":"https://rgenomicsetl.github.io/duckhts/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sounkou Mahamane Toure. Author, maintainer. James K Bonfield, John Marshall,Petr Danecek ,Heng Li , Valeriu Ohan, Andrew Whitwham,Thomas Keane , Robert M Davies. Contributor.           Htslib Authors DuckDB C Extension API Authors. Contributor.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Toure S (2026). Rduckhts: 'DuckDB' High Throughput Sequencing File Formats Reader Extension. R package version 0.1.3-0.0.1, https://github.com/RGenomicsETL/duckhts.","code":"@Manual{,   title = {Rduckhts: 'DuckDB' High Throughput Sequencing File Formats Reader Extension},   author = {Sounkou Mahamane Toure},   year = {2026},   note = {R package version 0.1.3-0.0.1},   url = {https://github.com/RGenomicsETL/duckhts}, }"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"rduckhts-duckdb-hts-file-reader-extension-for-r","dir":"","previous_headings":"","what":"DuckDB High Throughput Sequencing File Formats Reader Extension","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Rduckhts provides R interface DuckDB HTS (High Throughput Sequencing) file reader extension. enables reading common bioinformatics file formats VCF/BCF, SAM/BAM/CRAM, FASTA, FASTQ, GFF, GTF, tabix-indexed files directly R using SQL queries via duckhts.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"how-it-works","dir":"","previous_headings":"","what":"How it works","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Following RBCFTools, tables created returned instead data frames. VCF/BCF, SAM/BAM/CRAM, FASTA, FASTQ, GFF, GTF, tabix formats can queried. support region queries indexed files, target Linux, macOS, RTools. htslib 1.23 bundled build dependencies stay minimal. extensnion built adapting generic extension infracstructure using makefiles unlike submitted communtity extension duckhts.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"package can installed r-universe","code":"# Install 'Rduckhts' in R: install.packages('Rduckhts', repos = c('https://rgenomicsetl.r-universe.dev', 'https://cloud.r-project.org')) # When on CRAN install.packages(\"Rduckhts\")"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"system-requirements","dir":"","previous_headings":"","what":"System Requirements","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Installation requires htslib dependencies ad zlib libbz2, optionally full functionally liblzma, libcurl, openssl. package requires GNU make. Windows’s Rtools, htslib plugins enabled.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"extension loaded rduckhts_load(con, extension_path = NULL). can create tables rduckhts_bcf, rduckhts_bam, rduckhts_fasta, rduckhts_fastq, rduckhts_gff, rduckhts_gtf, rduckhts_tabix using parameters documented help pages. FASTA indexes can created rduckhts_fasta_index().","code":"library(DBI) library(duckdb) library(Rduckhts)   fasta_path <- system.file(\"extdata\", \"ce.fa\", package = \"Rduckhts\") fastq_r1 <- system.file(\"extdata\", \"r1.fq\", package = \"Rduckhts\") fastq_r2 <- system.file(\"extdata\", \"r2.fq\", package = \"Rduckhts\") con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE  rduckhts_fasta(con, \"sequences\", fasta_path, overwrite = TRUE) rduckhts_fastq(con, \"reads\", fastq_r1, mate_path = fastq_r2, overwrite = TRUE)  dbGetQuery(con, \"SELECT COUNT(*) AS n FROM sequences\") #>   n #> 1 7 dbGetQuery(con, \"SELECT COUNT(*) AS n FROM reads\") #>    n #> 1 10"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"fasta-region-queries","dir":"","previous_headings":"Quick Start","what":"FASTA region queries","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"read_fasta now supports indexed region queries via rduckhts_fasta(..., region = ...).","code":"fai_info <- rduckhts_fasta_index(con, fasta_path) fai_info #>   success index_path #> 1    TRUE  rduckhts_fasta(   con, \"fasta_region\", fasta_path,   region = \"CHROMOSOME_I:1-25\",   overwrite = TRUE ) dbGetQuery(con, \"SELECT NAME, length(SEQUENCE) AS n FROM fasta_region\") #>           NAME  n #> 1 CHROMOSOME_I 25"},{"path":[]},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"region-queries","dir":"","previous_headings":"Examples","what":"Region Queries","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Region queries can use implicit sidecar indexes explicit index_path custom index names/locations.","code":"bcf_path <- system.file(\"extdata\", \"vcf_file.bcf\", package = \"Rduckhts\") bcf_index_path <- system.file(\"extdata\", \"vcf_file.bcf.csi\", package = \"Rduckhts\") rduckhts_bcf(con, \"variants\", bcf_path, overwrite = TRUE) variants <- dbGetQuery(con, \"SELECT * FROM variants LIMIT 5\") variants #>   CHROM     POS    ID  REF  ALT  QUAL FILTER INFO_TEST INFO_DP4 INFO_AC INFO_AN #> 1     1 3000150  <NA>    C    T  59.2   PASS        NA       NA       2       4 #> 2     1 3000151  <NA>    C    T  59.2   PASS        NA       NA       2       4 #> 3     1 3062915  id3D GTTT    G  12.9    q10        NA        1       2       4 #> 4     1 3062915 idSNP    G T, C  12.6   test         5        1    1, 1       3 #> 5     1 3106154  <NA> CAAA    C 342.0   PASS        NA       NA       2       4 #>   INFO_INDEL INFO_STR FORMAT_TT_A FORMAT_GT_A FORMAT_GQ_A FORMAT_DP_A #> 1      FALSE     <NA>        NULL         0/1         245          NA #> 2      FALSE     <NA>        NULL         0/1         245          32 #> 3       TRUE     test        NULL         0/1         409          35 #> 4      FALSE     <NA>        0, 1         0/1         409          35 #> 5      FALSE     <NA>        NULL         0/1         245          32 #>                  FORMAT_GL_A FORMAT_TT_B FORMAT_GT_B FORMAT_GQ_B FORMAT_DP_B #> 1                       NULL        NULL         0/1         245          NA #> 2                       NULL        NULL         0/1         245          32 #> 3               -20, -5, -20        NULL         0/1         409          35 #> 4 -20, -5, -20, -20, -5, -20        0, 1          2|         409          35 #> 5                       NULL        NULL         0/1         245          32 #>    FORMAT_GL_B #> 1         NULL #> 2         NULL #> 3 -20, -5, -20 #> 4 -20, -5, -20 #> 5         NULL  rduckhts_bcf(   con, \"variants_idx\", bcf_path,   region = \"1:3000150-3000151\",   index_path = bcf_index_path,   overwrite = TRUE ) dbGetQuery(con, \"SELECT count(*) AS n FROM variants_idx\") #>   n #> 1 2  # Span-oriented index view from the same file index_spans_preview <- rduckhts_hts_index_spans(con, bcf_path, index_path = bcf_index_path) head(index_spans_preview[, c(\"seqname\", \"tid\", \"index_type\", \"chunk_beg_vo\", \"chunk_end_vo\")], 5) #>   seqname tid index_type chunk_beg_vo chunk_end_vo #> 1       1   0        CSI           NA           NA #> 2       2   1        CSI           NA           NA #> 3       3   2        CSI           NA           NA #> 4       4   3        CSI           NA           NA"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"remote-vcf-on-s3","dir":"","previous_headings":"Examples","what":"Remote VCF on S3","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"S3 files can query htslib built plugins enable. case RTools","code":"# Enable htslib plugins for remote access (S3/GCS/HTTP) setup_hts_env()  # Example S3 URL (1000 Genomes cohort VCF) s3_base <- \"s3://1000genomes-dragen-v3.7.6/data/cohorts/\" s3_path <- \"gvcf-genotyper-dragen-3.7.6/hg19/3202-samples-cohort/\" s3_vcf_file <- \"3202_samples_cohort_gg_chr22.vcf.gz\" s3_vcf_uri <- paste0(s3_base, s3_path, s3_vcf_file)  rduckhts_bcf(con, \"s3_variants\", s3_vcf_uri, region = \"chr22:16050000-16050500\", overwrite = TRUE) dbGetQuery(con, \"SELECT CHROM, COUNT(*) AS n FROM s3_variants GROUP BY CHROM\") #>   CHROM  n #> 1 chr22 11"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"fastq-files","dir":"","previous_headings":"Examples","what":"FASTQ files","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Three modes fastq files, single, paired interleaved","code":"r1 <- system.file(\"extdata\", \"r1.fq\", package = \"Rduckhts\") r2 <- system.file(\"extdata\", \"r2.fq\", package = \"Rduckhts\") interleaved <- system.file(\"extdata\", \"interleaved.fq\", package = \"Rduckhts\") rduckhts_fastq(con, \"paired_reads\", r1, mate_path = r2, overwrite = TRUE) rduckhts_fastq(con, \"interleaved_reads\", interleaved, interleaved = TRUE, overwrite = TRUE) pairs <- dbGetQuery(con, \"SELECT * FROM paired_reads WHERE MATE = 1 LIMIT 5\") pairs #>                              NAME DESCRIPTION #> 1 HS25_09827:2:1201:1505:59795#49        <NA> #> 2 HS25_09827:2:1201:1559:70726#49        <NA> #> 3 HS25_09827:2:1201:1564:39627#49        <NA> #> 4 HS25_09827:2:1201:1565:91731#49        <NA> #> 5 HS25_09827:2:1201:1624:69925#49        <NA> #>                                                                                               SEQUENCE #> 1 CCGTTAGAGCATTTGTTGAAAATGCTTTCCTTGCTCCATGTGATGACTCTGGTGCCCTTGTCAAAAGCCAGCTGGGCCTATTCGTGTGGGTCTGTTTCTG #> 2 TTGTTAAAATGACCATACCCAAAGTGATCTACAGACTCAATACAATTTCTATTGAAATACCAATCACACTCTTCACAGAACTAGAAAAACAGTTCTAAAA #> 3 ACGCGGCAATCCAATGTGTGAGTTGAGAAGCGGTGAGGAGGGAATCCTAATTTTATGAGCAGGTCAGGACCGTGGGAGATACCTGACACCTGAGATGGTA #> 4 GACATGCCATAACATTCATGTTTTATGTGTACAAGTCAATGAATTTTAGTATATTTACAGAGTTGTATGACTGTCTCCACAATCTAATTTTAGGTTTCCA #> 5 GCCAGCCTCCTTCTCAATGGTCTTTTTAAACATTATATGAAAACCAGACATTTACATTTGATTTCTTTTTCAATACTATACAGTTCTAAGAGAAAAAACA #>                                                                                                QUALITY #> 1 CABCFGDEEFFEFHGHGGFFGDIGIJFIFHHGHEIFGHBCGHDIFBE9GIAICGGICFIBFGGHGDGGGHE?GIGDFGGHEGIEJG>;FG<GGHACEFGH #> 2 CABEFGFFGFHGGGGJGGFFGKIHHJFIEHHHGIEGGEHJGHDHFGHIGICIJEFIFGIF8GGHKFHGGFEI6GGGFIGHGGIE>EFCFHGGGHEJEAJE #> 3 BACCFGBFGFHGGJGHGGFEGHIGIJHFEH:HHEHGHHBGGH9IAGHGFHIFJFFAFGIFDIGHKEIG<C>F,CGD66?7EFI5EEG>EGGGGD5=HH6E #> 4 CABFFGFFJFHEGEGJGGDG?FIGHHHBGHHHGIIGHGHGGHDGHFHIDFCIKEGIFHGGII9HFFGGGEEIGGEEHGGEEGDEHFH>FGGGGHAFAHGE #> 5 CABEFGFGIFGGGJGHGGFH?FDHGHDHGHEHHJCGHHFHDHDHFGHIGHIFFHGHFGGGI9GHF@IGGH;FICGEFEIHGGIEEFC:DEGGGBDJHHFF #>   MATE                         PAIR_ID #> 1    1 HS25_09827:2:1201:1505:59795#49 #> 2    1 HS25_09827:2:1201:1559:70726#49 #> 3    1 HS25_09827:2:1201:1564:39627#49 #> 4    1 HS25_09827:2:1201:1565:91731#49 #> 5    1 HS25_09827:2:1201:1624:69925#49"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"gff-files","dir":"","previous_headings":"Examples","what":"GFF files","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"can open attributes maps","code":"gff_path <- system.file(\"extdata\", \"gff_file.gff.gz\", package = \"Rduckhts\") rduckhts_gff(con, \"genes\", gff_path, attributes_map = TRUE, overwrite = TRUE) gene_annotations <- dbGetQuery(con, \"SELECT seqname, start, \\\"end\\\" FROM genes WHERE feature = 'gene' LIMIT 5\") gene_annotations #>   seqname   start     end #> 1       X 2934816 2964270"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"bamcram","dir":"","previous_headings":"Examples","what":"BAM/CRAM","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"built htslib codec, CRAM can opened addition BAM files. index_path can also passed region scans non-standard index names.","code":"cram_path <- system.file(\"extdata\", \"range.cram\", package = \"Rduckhts\") ref_path <- system.file(\"extdata\", \"ce.fa\", package = \"Rduckhts\") bam_path <- system.file(\"extdata\", \"range.bam\", package = \"Rduckhts\") bam_index_path <- system.file(\"extdata\", \"range.bam.bai\", package = \"Rduckhts\")  rduckhts_bam(con, \"cram_reads\", cram_path, reference = ref_path, overwrite = TRUE) cram_reads <- dbGetQuery(con, \"SELECT QNAME, FLAG, POS, MAPQ FROM cram_reads LIMIT 5\") cram_reads #>                           QNAME FLAG  POS MAPQ #> 1 HS18_09653:4:1315:19857:61712  145  914   23 #> 2 HS18_09653:4:1308:11522:27107  161  934    0 #> 3 HS18_09653:4:2314:14991:85680   83 1020   10 #> 4 HS18_09653:4:2108:14085:93656  147 1122   60 #> 5  HS18_09653:4:1303:4347:38100   83 1137   37  rduckhts_bam(   con, \"bam_idx_reads\", bam_path,   region = \"CHROMOSOME_I:1-1000\",   index_path = bam_index_path,   overwrite = TRUE ) dbGetQuery(con, \"SELECT count(*) AS n FROM bam_idx_reads\") #>   n #> 1 2"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"samtags--auxiliary-tags","dir":"","previous_headings":"Examples","what":"SAMtags + auxiliary tags","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Standard SAMtags can exposed typed columns, remaining tags available via AUXILIARY_TAGS:","code":"aux_path <- system.file(\"extdata\", \"aux_tags.sam.gz\", package = \"Rduckhts\") rduckhts_bam(con, \"aux_reads\", aux_path, standard_tags = TRUE, auxiliary_tags = TRUE, overwrite = TRUE) dbGetQuery(con, \"SELECT RG, NM, map_extract(AUXILIARY_TAGS, 'XZ') AS XZ FROM aux_reads LIMIT 1\") #>   RG NM  XZ #> 1 x1  2 foo"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"tabix-headers--types","dir":"","previous_headings":"Examples","what":"Tabix headers + types","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Use header = TRUE use first non-meta row column names, auto_detect = TRUE / column_types control column typing:","code":"tabix_header <- system.file(\"extdata\", \"header_tabix.tsv.gz\", package = \"Rduckhts\") tabix_meta <- system.file(\"extdata\", \"meta_tabix.tsv.gz\", package = \"Rduckhts\")  rduckhts_tabix(con, \"header_tabix\", tabix_header, header = TRUE, overwrite = TRUE) dbGetQuery(con, \"SELECT chrom, pos FROM header_tabix LIMIT 2\") #>   chrom pos #> 1  chr1   1 #> 2  chr1   2  rduckhts_tabix(con, \"typed_tabix\", tabix_meta, auto_detect = TRUE, overwrite = TRUE) dbGetQuery(con, \"SELECT typeof(column1) AS column1_type FROM typed_tabix LIMIT 1\") #>   column1_type #> 1       BIGINT  rduckhts_tabix(con, \"typed_tabix_explicit\", tabix_header,                header = TRUE,                column_types = c(\"VARCHAR\", \"BIGINT\", \"VARCHAR\"),                overwrite = TRUE) dbGetQuery(con, \"SELECT pos + 1 AS pos_plus_one FROM typed_tabix_explicit LIMIT 1\") #>   pos_plus_one #> 1            2"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"hts-header-and-index-metadata","dir":"","previous_headings":"Examples","what":"HTS header and index metadata","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"Use metadata helpers inspect parsed headers, raw header lines, index summaries, span-oriented index views, raw index blobs.","code":"header_meta <- rduckhts_hts_header(con, bcf_path) head(header_meta[, c(\"record_type\", \"id\", \"number\", \"value_type\")], 5) #>   record_type   id number value_type #> 1  fileformat <NA>   <NA>       <NA> #> 2      FILTER PASS   <NA>       <NA> #> 3        INFO TEST      1    Integer #> 4      FORMAT   TT      A    Integer #> 5        INFO  DP4      4    Integer  header_raw <- rduckhts_hts_header(con, bcf_path, mode = \"raw\") head(header_raw[, c(\"idx\", \"raw\")], 5) #>   idx                  raw #> 1   0 ##fileformat=VCFv4.1 #> 2   1 ##fileformat=VCFv4.1 #> 3   2 ##fileformat=VCFv4.1 #> 4   3 ##fileformat=VCFv4.1 #> 5   4 ##fileformat=VCFv4.1  index_meta <- rduckhts_hts_index(con, bcf_path, index_path = bcf_index_path) head(index_meta[, c(\"seqname\", \"mapped\", \"unmapped\", \"index_type\")], 5) #>   seqname mapped unmapped index_type #> 1       1     11        0        CSI #> 2       2      1        0        CSI #> 3       3      1        0        CSI #> 4       4      2        0        CSI  index_spans <- rduckhts_hts_index_spans(con, bcf_path, index_path = bcf_index_path) head(index_spans[, c(\"seqname\", \"tid\", \"index_type\", \"chunk_beg_vo\", \"chunk_end_vo\")], 5) #>   seqname tid index_type chunk_beg_vo chunk_end_vo #> 1       1   0        CSI           NA           NA #> 2       2   1        CSI           NA           NA #> 3       3   2        CSI           NA           NA #> 4       4   3        CSI           NA           NA  index_raw <- rduckhts_hts_index_raw(con, bcf_path, index_path = bcf_index_path) head(index_raw, 1) #> [1] index_type                                                        #> [2] '/usr/local/lib/R/site-library/Rduckhts/extdata/vcf_file.bcf.csi' #> [3] raw                                                               #> <0 rows> (or 0-length row.names)"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"remote-gtex-tabix-example","dir":"","previous_headings":"Examples","what":"Remote GTEx tabix example","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"GTEx eQTL matrices EBI tabix-indexed","code":"gtex_url <- \"http://ftp.ebi.ac.uk/pub/databases/spot/eQTL/imported/GTEx_V8/ge/Brain_Cerebellar_Hemisphere.tsv.gz\"  rduckhts_tabix(con, \"gtex_eqtl\", gtex_url, region = \"1:11868-14409\",                  header = TRUE, auto_detect = TRUE, overwrite = TRUE) dbGetQuery(con, \"SELECT * FROM gtex_eqtl LIMIT 5\") #>          variant r2    pvalue molecular_trait_object_id molecular_trait_id #> 1 chr1_13550_G_A NA 0.0204520           ENSG00000188290    ENSG00000188290 #> 2 chr1_13550_G_A NA 0.0303633           ENSG00000230699    ENSG00000230699 #> 3 chr1_13550_G_A NA 0.1057900           ENSG00000177757    ENSG00000177757 #> 4 chr1_13550_G_A NA 0.1617190           ENSG00000241860    ENSG00000241860 #> 5 chr1_13550_G_A NA 0.1919580           ENSG00000198744    ENSG00000198744 #>         maf         gene_id median_tpm      beta       se  an ac chromosome #> 1 0.0114286 ENSG00000188290  6.3960000  0.633986 0.270285 350  4          1 #> 2 0.0114286 ENSG00000230699  0.0674459 -0.980082 0.447861 350  4          1 #> 3 0.0114286 ENSG00000177757  1.2659000  0.631359 0.387738 350  4          1 #> 4 0.0114286 ENSG00000241860  0.1081970 -0.791695 0.562674 350  4          1 #> 5 0.0114286 ENSG00000198744 21.6284000 -0.592354 0.451705 350  4          1 #>   position ref alt type        rsid #> 1    13550   G   A  SNP rs554008981 #> 2    13550   G   A  SNP rs554008981 #> 3    13550   G   A  SNP rs554008981 #> 4    13550   G   A  SNP rs554008981 #> 5    13550   G   A  SNP rs554008981 dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"DuckDB: https://duckdb.org/ DuckDB Extension API: https://duckdb.org/docs/extensions/overview DuckDB extension template (C): https://github.com/duckdb/extension-template-c htslib: https://github.com/samtools/htslib RBCFTools: https://github.com/RGenomicsETL/RBCFTools","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"DuckDB High Throughput Sequencing File Formats Reader Extension","text":"GPL-3.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/Rduckhts.html","id":null,"dir":"Reference","previous_headings":"","what":"DuckDB HTS File Reader Extension for R — Rduckhts","title":"DuckDB HTS File Reader Extension for R — Rduckhts","text":"Rduckhts package provides interface DuckDB HTS (High Throughput Sequencing) file reader extension within R. enables reading common bioinformatics file formats VCF/BCF, SAM/BAM/CRAM, FASTA, FASTQ, GFF, GTF, tabix-indexed files directly R using SQL queries via DuckDB.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/Rduckhts.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"DuckDB HTS File Reader Extension for R — Rduckhts","text":"https://github.com/RGenomicsETL/duckhts","code":""},{"path":[]},{"path":"https://rgenomicsetl.github.io/duckhts/reference/Rduckhts.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DuckDB HTS File Reader Extension for R — Rduckhts","text":"DuckHTS Contributors","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/detect_complex_types.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect Complex Types in DuckDB Table — detect_complex_types","title":"Detect Complex Types in DuckDB Table — detect_complex_types","text":"Identifies columns DuckDB table contain complex types (ARRAY MAP) returned R lists.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/detect_complex_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect Complex Types in DuckDB Table — detect_complex_types","text":"","code":"detect_complex_types(con, table_name)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/detect_complex_types.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect Complex Types in DuckDB Table — detect_complex_types","text":"con DuckDB connection table_name Name table analyze","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/detect_complex_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect Complex Types in DuckDB Table — detect_complex_types","text":"data frame columns complex types, showing   column_name, column_type, description R type.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/detect_complex_types.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Detect Complex Types in DuckDB Table — detect_complex_types","text":"","code":"library(DBI) library(duckdb)  con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE bcf_path <- system.file(\"extdata\", \"vcf_file.bcf\", package = \"Rduckhts\") rduckhts_bcf(con, \"variants\", bcf_path, overwrite = TRUE) complex_cols <- detect_complex_types(con, \"variants\") print(complex_cols) #>    column_name column_type r_type                   description #> 5          ALT   VARCHAR[] vector ARRAY type - will be R vector #> 7       FILTER   VARCHAR[] vector ARRAY type - will be R vector #> 10     INFO_AC   INTEGER[] vector ARRAY type - will be R vector #> 14 FORMAT_TT_A   INTEGER[] vector ARRAY type - will be R vector #> 18 FORMAT_GL_A     FLOAT[] vector ARRAY type - will be R vector #> 19 FORMAT_TT_B   INTEGER[] vector ARRAY type - will be R vector #> 23 FORMAT_GL_B     FLOAT[] vector ARRAY type - will be R vector dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckdb_type_mappings.html","id":null,"dir":"Reference","previous_headings":"","what":"DuckDB to R Type Mappings — duckdb_type_mappings","title":"DuckDB to R Type Mappings — duckdb_type_mappings","text":"mapping covers common data types used HTS file processing: BIGINT <-> double (integer due 64-bit overflow protection) DOUBLE <-> numeric/double VARCHAR <-> character/string BOOLEAN <-> logical ARRAY types (e.g., VARCHAR[], BIGINT[]) <-> list MAP types (e.g., MAP(VARCHAR, VARCHAR)) <-> data.frame Important notes: 64-bit integers (BIGINT, UBIGINT) become double prevent overflow DATE/TIME values return Unix epoch numbers (double) MAP types become data frames 'key' 'value' columns ARRAY types become vectors (lists R terminology)","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckdb_type_mappings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DuckDB to R Type Mappings — duckdb_type_mappings","text":"","code":"duckdb_type_mappings()"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckdb_type_mappings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DuckDB to R Type Mappings — duckdb_type_mappings","text":"named list two elements: duckdb_to_r Named character vector mapping DuckDB types R types r_to_duckdb Named character vector mapping R types DuckDB types","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckdb_type_mappings.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"DuckDB to R Type Mappings — duckdb_type_mappings","text":"Returns named list mapping DuckDB R data types. useful understanding type conversions reading HTS files specifying column types tabix functions.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckdb_type_mappings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DuckDB to R Type Mappings — duckdb_type_mappings","text":"","code":"mappings <- duckdb_type_mappings() mappings$duckdb_to_r[\"BIGINT\"] #>   BIGINT  #> \"double\"  mappings$r_to_duckdb[\"integer\"] #>   integer  #> \"INTEGER\""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_append_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Append DuckDB extension metadata trailer to a shared library — duckhts_append_metadata","title":"Append DuckDB extension metadata trailer to a shared library — duckhts_append_metadata","text":"Append DuckDB extension metadata trailer shared library","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_append_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Append DuckDB extension metadata trailer to a shared library — duckhts_append_metadata","text":"","code":"duckhts_append_metadata(ext_file, verbose = FALSE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Bootstrap the duckhts extension sources into the R package — duckhts_bootstrap","title":"Bootstrap the duckhts extension sources into the R package — duckhts_bootstrap","text":"Copies extension source files parent duckhts repository inst/duckhts_extension/ R package becomes self-contained. Run R CMD build prepare source tarball.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bootstrap the duckhts extension sources into the R package — duckhts_bootstrap","text":"","code":"duckhts_bootstrap(repo_root = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bootstrap the duckhts extension sources into the R package — duckhts_bootstrap","text":"repo_root Path duckhts repository root. Required.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bootstrap the duckhts extension sources into the R package — duckhts_bootstrap","text":"Invisibly returns destination directory.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_build.html","id":null,"dir":"Reference","previous_headings":"","what":"Build the duckhts DuckDB extension — duckhts_build","title":"Build the duckhts DuckDB extension — duckhts_build","text":"Compiles htslib duckhts extension sources bundled installed R package. built .duckdb_extension file placed extension directory.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_build.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build the duckhts DuckDB extension — duckhts_build","text":"","code":"duckhts_build(build_dir = NULL, make = NULL, force = FALSE, verbose = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_build.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build the duckhts DuckDB extension — duckhts_build","text":"build_dir build. Required. Use writable location tempdir() installed package directory read-. make Optional GNU make command use (e.g., \"gmake\" \"make\"). NULL, auto-detects gmake make. non-GNU make used, htslib's configure step fail. force Rebuild even extension file already exists. verbose Print build output.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_build.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build the duckhts DuckDB extension — duckhts_build","text":"Path built duckhts.duckdb_extension file.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_detect_platform.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect DuckDB platform string — duckhts_detect_platform","title":"Detect DuckDB platform string — duckhts_detect_platform","text":"Detect DuckDB platform string","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_detect_platform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect DuckDB platform string — duckhts_detect_platform","text":"","code":"duckhts_detect_platform()"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_load.html","id":null,"dir":"Reference","previous_headings":"","what":"Load the duckhts extension into a DuckDB connection — duckhts_load","title":"Load the duckhts extension into a DuckDB connection — duckhts_load","text":"Load duckhts extension DuckDB connection","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_load.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load the duckhts extension into a DuckDB connection — duckhts_load","text":"","code":"duckhts_load(con = NULL, extension_path = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_load.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load the duckhts extension into a DuckDB connection — duckhts_load","text":"con existing DuckDB connection, NULL create one. extension_path Explicit path .duckdb_extension file. NULL, uses default location installed package.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/duckhts_load.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load the duckhts extension into a DuckDB connection — duckhts_load","text":"DuckDB connection (invisibly).","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_array_element.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Array Elements Safely — extract_array_element","title":"Extract Array Elements Safely — extract_array_element","text":"Helper function safely extract elements DuckDB arrays (returned R lists) proper error handling.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_array_element.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Array Elements Safely — extract_array_element","text":"","code":"extract_array_element(array_col, index = NULL, default = NA)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_array_element.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Array Elements Safely — extract_array_element","text":"array_col list column DuckDB array data index Numeric index (1-based). NULL, returns full list default Default value index bounds","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_array_element.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Array Elements Safely — extract_array_element","text":"array element specified index, full array index NULL","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_array_element.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Array Elements Safely — extract_array_element","text":"","code":"library(DBI) library(duckdb)  con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE bcf_path <- system.file(\"extdata\", \"vcf_file.bcf\", package = \"Rduckhts\") rduckhts_bcf(con, \"variants\", bcf_path, overwrite = TRUE) data <- dbGetQuery(con, \"SELECT ALT FROM variants LIMIT 5\") first_alt <- extract_array_element(data$ALT, 1) all_alts <- extract_array_element(data$ALT) dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_map_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract MAP Keys and Values — extract_map_data","title":"Extract MAP Keys and Values — extract_map_data","text":"Helper function work DuckDB MAP data (returned data frames). Can extract keys, values, search specific key-value pairs.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_map_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract MAP Keys and Values — extract_map_data","text":"","code":"extract_map_data(map_col, operation = \"keys\", default = NA)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_map_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract MAP Keys and Values — extract_map_data","text":"map_col data frame column DuckDB MAP data operation extract: \"keys\", \"values\", specific key name default Default value key found (used operation key name)","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_map_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract MAP Keys and Values — extract_map_data","text":"Extracted data based operation","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/extract_map_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract MAP Keys and Values — extract_map_data","text":"","code":"library(DBI) library(duckdb)  con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE gff_path <- system.file(\"extdata\", \"gff_file.gff.gz\", package = \"Rduckhts\") rduckhts_gff(con, \"annotations\", gff_path, attributes_map = TRUE, overwrite = TRUE) data <- dbGetQuery(con, \"SELECT attributes FROM annotations LIMIT 5\") keys <- extract_map_data(data$attributes, \"keys\") name_values <- extract_map_data(data$attributes, \"Name\") dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/normalize_tabix_types.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","title":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","text":"Normalizes R data type names corresponding DuckDB types use tabix readers. function handles common R type name variations maps appropriate DuckDB column types.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/normalize_tabix_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","text":"","code":"normalize_tabix_types(types)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/normalize_tabix_types.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","text":"types character vector R data type names normalized.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/normalize_tabix_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","text":"character vector normalized DuckDB type names suitable tabix columns.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/normalize_tabix_types.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","text":"function performs following normalizations: Integer types (integer, int, int32, int64) -> BIGINT Numeric types (numeric, double, float) -> DOUBLE Character types (character, string, chr) -> VARCHAR Logical types (logical, bool, boolean) -> BOOLEAN types -> Converted uppercase -empty vector provided, returns empty vector unchanged.","code":""},{"path":[]},{"path":"https://rgenomicsetl.github.io/duckhts/reference/normalize_tabix_types.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize R Data Types to DuckDB Types for Tabix — normalize_tabix_types","text":"","code":"normalize_tabix_types(c(\"integer\", \"character\", \"numeric\")) #> [1] \"BIGINT\"  \"VARCHAR\" \"DOUBLE\"  normalize_tabix_types(c(\"int\", \"string\", \"float\")) #> [1] \"BIGINT\"  \"VARCHAR\" \"DOUBLE\""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bam.html","id":null,"dir":"Reference","previous_headings":"","what":"Create SAM/BAM/CRAM Table — rduckhts_bam","title":"Create SAM/BAM/CRAM Table — rduckhts_bam","text":"Creates DuckDB table SAM, BAM, CRAM files using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bam.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create SAM/BAM/CRAM Table — rduckhts_bam","text":"","code":"rduckhts_bam(   con,   table_name,   path,   region = NULL,   index_path = NULL,   reference = NULL,   standard_tags = NULL,   auxiliary_tags = NULL,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bam.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create SAM/BAM/CRAM Table — rduckhts_bam","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path SAM/BAM/CRAM file region Optional genomic region (e.g., \"chr1:1000-2000\") index_path Optional explicit path index file (.bai/.csi/.crai) reference Optional reference file path CRAM files standard_tags Logical. TRUE, include typed standard SAMtags columns auxiliary_tags Logical. TRUE, include AUXILIARY_TAGS map non-standard tags overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bam.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create SAM/BAM/CRAM Table — rduckhts_bam","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bam.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create SAM/BAM/CRAM Table — rduckhts_bam","text":"","code":"library(DBI) library(duckdb)  con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE bam_path <- system.file(\"extdata\", \"range.bam\", package = \"Rduckhts\") rduckhts_bam(con, \"reads\", bam_path, overwrite = TRUE) dbGetQuery(con, \"SELECT COUNT(*) FROM reads WHERE FLAG & 4 = 0\") #>   count_star() #> 1          112 dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bcf.html","id":null,"dir":"Reference","previous_headings":"","what":"Create VCF/BCF Table — rduckhts_bcf","title":"Create VCF/BCF Table — rduckhts_bcf","text":"Creates DuckDB table VCF BCF file using DuckHTS extension. follows RBCFTools pattern creating table can queried.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bcf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create VCF/BCF Table — rduckhts_bcf","text":"","code":"rduckhts_bcf(   con,   table_name,   path,   region = NULL,   index_path = NULL,   tidy_format = FALSE,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bcf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create VCF/BCF Table — rduckhts_bcf","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path VCF/BCF file region Optional genomic region (e.g., \"chr1:1000-2000\") index_path Optional explicit path index file (.csi/.tbi) tidy_format Logical. TRUE, FORMAT columns returned tidy format overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bcf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create VCF/BCF Table — rduckhts_bcf","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_bcf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create VCF/BCF Table — rduckhts_bcf","text":"","code":"library(DBI) library(duckdb)  con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE bcf_path <- system.file(\"extdata\", \"vcf_file.bcf\", package = \"Rduckhts\") rduckhts_bcf(con, \"variants\", bcf_path, overwrite = TRUE) dbGetQuery(con, \"SELECT * FROM variants LIMIT 2\") #>   CHROM     POS   ID REF ALT QUAL FILTER INFO_TEST INFO_DP4 INFO_AC INFO_AN #> 1     1 3000150 <NA>   C   T 59.2   PASS        NA       NA       2       4 #> 2     1 3000151 <NA>   C   T 59.2   PASS        NA       NA       2       4 #>   INFO_INDEL INFO_STR FORMAT_TT_A FORMAT_GT_A FORMAT_GQ_A FORMAT_DP_A #> 1      FALSE     <NA>        NULL         0/1         245          NA #> 2      FALSE     <NA>        NULL         0/1         245          32 #>   FORMAT_GL_A FORMAT_TT_B FORMAT_GT_B FORMAT_GQ_B FORMAT_DP_B FORMAT_GL_B #> 1        NULL        NULL         0/1         245          NA        NULL #> 2        NULL        NULL         0/1         245          32        NULL dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta.html","id":null,"dir":"Reference","previous_headings":"","what":"Create FASTA Table — rduckhts_fasta","title":"Create FASTA Table — rduckhts_fasta","text":"Creates DuckDB table FASTA files using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create FASTA Table — rduckhts_fasta","text":"","code":"rduckhts_fasta(   con,   table_name,   path,   region = NULL,   index_path = NULL,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create FASTA Table — rduckhts_fasta","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path FASTA file region Optional genomic region (e.g., \"chr1:1000-2000\" \"chr1:1-10,chr2:5-20\") index_path Optional explicit path FASTA index file (.fai) overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create FASTA Table — rduckhts_fasta","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Build FASTA Index — rduckhts_fasta_index","title":"Build FASTA Index — rduckhts_fasta_index","text":"Builds FASTA index (.fai) using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build FASTA Index — rduckhts_fasta_index","text":"","code":"rduckhts_fasta_index(con, path, index_path = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build FASTA Index — rduckhts_fasta_index","text":"con DuckDB connection DuckHTS loaded path Path FASTA file index_path Optional explicit output path FASTA index file (.fai)","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fasta_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build FASTA Index — rduckhts_fasta_index","text":"data frame columns `success` `index_path`","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fastq.html","id":null,"dir":"Reference","previous_headings":"","what":"Create FASTQ Table — rduckhts_fastq","title":"Create FASTQ Table — rduckhts_fastq","text":"Creates DuckDB table FASTQ files using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fastq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create FASTQ Table — rduckhts_fastq","text":"","code":"rduckhts_fastq(   con,   table_name,   path,   mate_path = NULL,   interleaved = FALSE,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fastq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create FASTQ Table — rduckhts_fastq","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path FASTQ file mate_path Optional path mate file paired reads interleaved Logical indicating file interleaved paired reads overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_fastq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create FASTQ Table — rduckhts_fastq","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gff.html","id":null,"dir":"Reference","previous_headings":"","what":"Create GFF3 Table — rduckhts_gff","title":"Create GFF3 Table — rduckhts_gff","text":"Creates DuckDB table GFF3 files using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gff.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create GFF3 Table — rduckhts_gff","text":"","code":"rduckhts_gff(   con,   table_name,   path,   region = NULL,   attributes_map = FALSE,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gff.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create GFF3 Table — rduckhts_gff","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path GFF3 file region Optional genomic region (e.g., \"chr1:1000-2000\") attributes_map Logical. TRUE, returns attributes MAP column overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gff.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create GFF3 Table — rduckhts_gff","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gtf.html","id":null,"dir":"Reference","previous_headings":"","what":"Create GTF Table — rduckhts_gtf","title":"Create GTF Table — rduckhts_gtf","text":"Creates DuckDB table GTF files using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gtf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create GTF Table — rduckhts_gtf","text":"","code":"rduckhts_gtf(   con,   table_name,   path,   region = NULL,   attributes_map = FALSE,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gtf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create GTF Table — rduckhts_gtf","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path GTF file region Optional genomic region (e.g., \"chr1:1000-2000\") attributes_map Logical. TRUE, returns attributes MAP column overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_gtf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create GTF Table — rduckhts_gtf","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_header.html","id":null,"dir":"Reference","previous_headings":"","what":"Read HTS Header Metadata — rduckhts_hts_header","title":"Read HTS Header Metadata — rduckhts_hts_header","text":"Reads file header records HTS-supported formats using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_header.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read HTS Header Metadata — rduckhts_hts_header","text":"","code":"rduckhts_hts_header(con, path, format = NULL, mode = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_header.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read HTS Header Metadata — rduckhts_hts_header","text":"con DuckDB connection DuckHTS loaded path Path input HTS file format Optional format hint (e.g., \"auto\", \"vcf\", \"bcf\", \"bam\", \"cram\", \"tabix\") mode Header output mode: \"parsed\" (default), \"raw\", \"\"","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_header.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read HTS Header Metadata — rduckhts_hts_header","text":"data frame parsed header metadata.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Read HTS Index Metadata — rduckhts_hts_index","title":"Read HTS Index Metadata — rduckhts_hts_index","text":"Reads index metadata HTS-supported index files via DuckHTS.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read HTS Index Metadata — rduckhts_hts_index","text":"","code":"rduckhts_hts_index(con, path, format = NULL, index_path = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read HTS Index Metadata — rduckhts_hts_index","text":"con DuckDB connection DuckHTS loaded path Path input HTS file format Optional format hint (e.g., \"auto\", \"vcf\", \"bcf\", \"bam\", \"cram\", \"tabix\") index_path Optional explicit path index file","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read HTS Index Metadata — rduckhts_hts_index","text":"data frame index metadata.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_raw.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Raw HTS Index Blob — rduckhts_hts_index_raw","title":"Read Raw HTS Index Blob — rduckhts_hts_index_raw","text":"Returns raw index metadata blob data file index.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_raw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Raw HTS Index Blob — rduckhts_hts_index_raw","text":"","code":"rduckhts_hts_index_raw(con, path, format = NULL, index_path = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_raw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Raw HTS Index Blob — rduckhts_hts_index_raw","text":"con DuckDB connection DuckHTS loaded path Path input HTS file format Optional format hint index_path Optional explicit path index file","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_raw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Raw HTS Index Blob — rduckhts_hts_index_raw","text":"data frame raw index blob metadata.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_spans.html","id":null,"dir":"Reference","previous_headings":"","what":"Read HTS Index Spans — rduckhts_hts_index_spans","title":"Read HTS Index Spans — rduckhts_hts_index_spans","text":"Returns index span-oriented metadata planning range workloads.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_spans.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read HTS Index Spans — rduckhts_hts_index_spans","text":"","code":"rduckhts_hts_index_spans(con, path, format = NULL, index_path = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_spans.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read HTS Index Spans — rduckhts_hts_index_spans","text":"con DuckDB connection DuckHTS loaded path Path input HTS file format Optional format hint index_path Optional explicit path index file","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_hts_index_spans.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read HTS Index Spans — rduckhts_hts_index_spans","text":"data frame span-oriented index metadata.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_load.html","id":null,"dir":"Reference","previous_headings":"","what":"Load DuckHTS Extension — rduckhts_load","title":"Load DuckHTS Extension — rduckhts_load","text":"Loads DuckHTS extension DuckDB connection. must called using HTS reader functions.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_load.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load DuckHTS Extension — rduckhts_load","text":"","code":"rduckhts_load(con, extension_path = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_load.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load DuckHTS Extension — rduckhts_load","text":"con DuckDB connection object extension_path Optional path duckhts extension file. NULL, try use bundled extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_load.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load DuckHTS Extension — rduckhts_load","text":"TRUE extension loaded successfully","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_load.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load DuckHTS Extension — rduckhts_load","text":"DuckDB connection must created allow_unsigned_extensions = \"true\".","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_load.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load DuckHTS Extension — rduckhts_load","text":"","code":"library(DBI) library(duckdb)  con <- dbConnect(duckdb::duckdb(config = list(allow_unsigned_extensions = \"true\"))) rduckhts_load(con) #> [1] TRUE dbDisconnect(con, shutdown = TRUE)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_tabix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Tabix-Indexed File Table — rduckhts_tabix","title":"Create Tabix-Indexed File Table — rduckhts_tabix","text":"Creates DuckDB table tabix-indexed file using DuckHTS extension.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_tabix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Tabix-Indexed File Table — rduckhts_tabix","text":"","code":"rduckhts_tabix(   con,   table_name,   path,   region = NULL,   index_path = NULL,   header = NULL,   header_names = NULL,   auto_detect = NULL,   column_types = NULL,   overwrite = FALSE )"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_tabix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Tabix-Indexed File Table — rduckhts_tabix","text":"con DuckDB connection DuckHTS loaded table_name Name created table path Path tabix-indexed file region Optional genomic region (e.g., \"chr1:1000-2000\") index_path Optional explicit path index file (.tbi/.csi) header Logical. TRUE, use first non-meta line column names header_names Character vector override column names auto_detect Logical. TRUE, infer basic numeric column types column_types Character vector column types (e.g. \"BIGINT\", \"VARCHAR\") overwrite Logical. TRUE, overwrites existing table","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/rduckhts_tabix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Tabix-Indexed File Table — rduckhts_tabix","text":"Invisible TRUE success","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/setup_hts_env.html","id":null,"dir":"Reference","previous_headings":"","what":"Setup HTSlib Environment — setup_hts_env","title":"Setup HTSlib Environment — setup_hts_env","text":"Sets `HTS_PATH` environment variable point bundled htslib plugins directory. enables remote file access via libcurl plugins (e.g., s3://, gs://, http://) plugins available.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/setup_hts_env.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Setup HTSlib Environment — setup_hts_env","text":"","code":"setup_hts_env(plugins_dir = NULL)"},{"path":"https://rgenomicsetl.github.io/duckhts/reference/setup_hts_env.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Setup HTSlib Environment — setup_hts_env","text":"plugins_dir Optional path htslib plugins directory. NULL, uses bundled plugins directory available.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/setup_hts_env.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Setup HTSlib Environment — setup_hts_env","text":"Invisibly returns previous value `HTS_PATH` (`NA` unset).","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/setup_hts_env.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Setup HTSlib Environment — setup_hts_env","text":"Call querying remote URLs allow htslib locate plugins.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/reference/setup_hts_env.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Setup HTSlib Environment — setup_hts_env","text":"","code":"if (FALSE) { # \\dontrun{ setup_hts_env()  plugins_path <- tempfile(\"hts_plugins_\") dir.create(plugins_path) setup_hts_env(plugins_dir = plugins_path) unlink(plugins_path, recursive = TRUE) } # }"},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-012-015","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.2-0.1.5","title":"Rduckhts 0.1.2-0.1.5","text":"Fixed inadvertant removal libexec Updated plugin add header table functions","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-012-014","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.2-0.1.4","title":"Rduckhts 0.1.2-0.1.4","text":"CRAN release: 2026-02-23 CRAN Submission","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-012-009000","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.2-0.0.9000","title":"Rduckhts 0.1.2-0.0.9000","text":"Updated DESCRIPTION Title/Description formatting added HTSlib reference. Removed default write paths bootstrap/build helpers; now require explicit paths. setup_hts_env now accepts explicit plugins_dir parameter. duckhts_build now accepts make argument (GNU make required). modified configure attemp support wasm Update bootstrapped extension code match duckhts 0.1.2. Add SAMtags + auxiliary tag support (standard_tags, auxiliary_tags). Add tabix header/typing options (header, header_names, auto_detect, column_types).","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-011-003","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.1-0.0.3","title":"Rduckhts 0.1.1-0.0.3","text":"make build single threaded","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-011-003-1","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.1-0.0.3","title":"Rduckhts 0.1.1-0.0.3","text":"misspeling correction","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-011-002","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.1-0.0.2","title":"Rduckhts 0.1.1-0.0.2","text":"CRAN resubmission: apply DuckDB C API header patch avoid strict-prototypes warnings.","code":""},{"path":"https://rgenomicsetl.github.io/duckhts/news/index.html","id":"rduckhts-011-001","dir":"Changelog","previous_headings":"","what":"Rduckhts 0.1.1-0.0.1","title":"Rduckhts 0.1.1-0.0.1","text":"CRAN Submission Bump bundled duckhts extension version 0.1.1. Initial development release. Bundles DuckHTS DuckDB extension htslib HTS file readers. Adds table-creation helpers VCF/BCF, BAM/CRAM, FASTA/FASTQ, GFF/GTF, tabix.","code":""}]
